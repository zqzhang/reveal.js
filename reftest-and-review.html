<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>How to Write W3C Reftests and Review W3C Tests</title>

    <meta name="description" content="A session of Test the Web Forward at Shenzhen" href="http://testthewebforward.org/events/2013/shenzhen.html">
    <meta name="presdate" content="20131109">
    <meta name="author" content="Zhiqiang Zhang" href="mailto:zhiqiang.zhang@intel.com">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <div class="slides">

        <section>
          <h1>How to Write W3C Reftests</h1>
          <p>
            <i>Zhiqiang Zhang (<a href="https://github.com/zqzhang" class="url Nickname">zqzhang</a>), <a class="org" href="http://www.intel.com/">Intel</a></i>
          </p>
        </section>

        <!-- Reftest -->
        <section>
          <section>
            <h2>Start from Example in Spec</h2>
            <img src="support/reftest-spec-example.png">
            <p>Example 14.3 in CSS3 <a href="http://www.w3.org/TR/css3-background/#the-background-size">background-size</a></p>
          </section>
          <section>
            <h2>To Checkpoints</h2>
            <ul>
              <li><code>background-size: length auto</code>:
              <br>scale the image width to 'length' and height to (1) the image's intrinsic ratio and the size of width, or (2) the image's intrinsic size, or (3) 100%</li>
              <li><code>background-repeat: round repeat</code>:
              <br>scale the image in width so that it fits a whole number of times in the background positioning area</li>
              <li><code>round</code> for width and <code>auto</code> for height, so height is scaled to keep the image's original aspect ratio</li>
            </ul>
          </section>
          <section>
            <h2>Copy Test Case Template</h2>
            <pre><code data-trim contenteditable>
&lt;!DOCTYPE html&gt;
&lt;title&gt;[Test Area]: [Title/Scope of Test]&lt;/title&gt;
&lt;link rel="author" title="[Name of Author]" href=mailto:EMAIL OR 
  http://CONTACT_PAGE"&gt;
&lt;link rel="help" href="http://www.w3.org/TR/[direct link to tested 
  section]"&gt;
&lt;link rel="match" href="[path to reference file]"&gt;
&lt;meta name="flags" content="[requirement flags]"&gt;
&lt;meta name="assert" content="Test checks that [explanation of what 
  you're trying to test]."&gt;
&lt;style&gt;
    [CSS for test]
&lt;/style&gt;
&lt;body&gt;
    &lt;p&gt; Test passes if [description of pass condition].&lt;/p&gt;
    [Content of test]
&lt;/body&gt;
            </code></pre>
            <p><a href="http://testthewebforward.org/docs/test-templates.html#reftest-templates">Reftest Test Case Template</a></p>
          </section>
          <section>
            <h2>To Test Case: Style</h2>
            <img src="support/reftest-style.png">
          </section>
          <section>
            <h2>To Test Case: Pass Condition</h2>
            <img src="support/reftest-pass-condition.png">
          </section>
          <section>
            <h2>Try Test Case on Browsers</h2>
            <img src="support/reftest-opera12.png">
          </section>
          <section>
            <h2>Try Test Case on Browsers</h2>
            <img src="support/reftest-chrome28.png">
            <img src="support/reftest-firefox23.png">
          </section>
          <section>
            <h2>Complete Test File</h2>
            <a href="http://test.csswg.org/source/contributors/intel/submitted/css3-background/background-size-029.html">http://test.csswg.org/source/contributors/intel/submitted/css3-background/background-size-029.html</a>
          </section>
          <section>
            <h2>Reference File</h2>
            <ul>
              <p>The reference file should look exactly like the test file, except that the code behind it is different.</p>
              <br>
              <li>The <code>assert</code> metadata is taken out.</li>
              <li>The <code>title</code> is generic, as this file can and may be shared among multiple tests</li>
              <li>The <code>match</code> (or <code>mismatch</code>) metadata not necessary</li>
              <li>The markup that created the actual test data is different: here, the same effect is created with very mundane, dependable technology.</li>
          </section>
          <section>
            <h2>Copy Reference File Template</h2>
            <pre><code data-trim contenteditable>
&lt;!DOCTYPE html&gt;
&lt;title&gt;[Test Area] Reference File&lt;/title&gt;
&lt;link rel="author" title="[Name of Author]" href=mailto:EMAIL OR 
  http://CONTACT_PAGE"&gt;
&lt;style&gt;
    [CSS for test]
&lt;/style&gt;
&lt;body&gt;
    &lt;p&gt; Test passes if [description of pass condition].&lt;/p&gt;
    [Content of test]
&lt;/body&gt;
            </code></pre>
            <p><a href="http://testthewebforward.org/docs/test-templates.html#reftest-templates">Reftest Reference Template</a></p>
          </section>
          <section>
            <h2>Reference File Source</h2>
            <img src="support/reftest-reference-style.png">
          </section>
          <section>
            <h2>Try Reference File on Browsers</h2>
            <img src="support/reftest-opera12-ref.png">
            <img src="support/reftest-opera12.png">
          </section>
          <section>
            <h2>Reftest</h2>
            <ul>
              <p><a href="http://testthewebforward.org/docs/reftests.html">Definition</a>:</p>
              <li>A reftest is a test that compares the visual output of one file (the test case) with the output of one or more other files (the references).</li>
              <p><a href="http://testthewebforward.org/docs/reftests.html#components-of-a-reftest">Components</a>:</p>
              <li>Test file: <a href="http://test.csswg.org/source/contributors/intel/submitted/css3-background/background-size-029.html">background-size-029.html</a></li>
              <li>Reference file: <a href="http://test.csswg.org/source/contributors/intel/submitted/css3-background/reference/background-size-029-ref.xht">background-size-029-ref.html</a></li>
              <li>Comparison:</li>
              <pre><code data-trim contenteditable>
&lt;link rel="match" href="reference/background-size-029-ref.xht"&gt;
              </code></pre>
            </ul>
          </section>
          <section>
            <h2>Continue to Improve the Test</h2>
            <img src="support/reftest-commits.png">
            <p><a href="http://hg.csswg.org/test/log/923e1f7bf2c6/contributors/intel/submitted/css3-background/background-size-029.html">Commits to background-size-029.html</a></p>
          </section>
          <section>
            <p>background-size-029.html: <a href="http://hg.csswg.org/test/file/1d2d1d9ae507/contributors/intel/submitted/css3-background/background-size-029.html">approved</a> v.s. <a href="http://hg.csswg.org/test/file/d266aff0a27a/contributors/intel/submitted/css3-background/background-size-029.html">initial</a></p>
            <img src="support/reftest-compare-metadata.png">
          </section>
          <section>
            <img src="support/reftest-compare-style.png">
          </section>
          <section>
            <img src="support/reftest-compare-body.png">
          </section>
        </section>

        <!-- Tips -->
        <section>
          <section>
            <h2>Tests to avoid: long test</h2>
            <ul>
              <li>Manual test</li>
              <li>Need to scroll to complete testing</li>
              <li><a href="http://www.hixie.ch/tests/evil/mixed/lineheight3.html">Example</a> of a test that is too long</li>
            </ul>
          </section>
          <section>
            <h2>Tests to avoid: "this should be red" test</h2>
            <ul>
              <li>In the <a href="http://testthewebforward.org/docs/test-style-guidelines.html#techniques">Test Style Guidelines</a> document, <span style="background-color:red">red</span> indicates a bug</li>
              <li>Nothing should ever be <span style="background-color:red">red</span> in a test.</li>
              <li>One exception: the test for the <span style="color:red">'red'</span> value for the color properties!</li>
            </li>
          </section>
          <section>
            <h2>Tests to avoid: unobvious test</h2>
            <img src="support/unobvious-test.png">
            <p>The last <a href="http://www.w3.org/Style/CSS/Test/CSS1/current/sec525.htm">subtest on this page</a> shows this problem.</p>
          </section>
          <section>
            <h2>Tips: vendor prefix</h2>
            <ul>
              <li>You may need to add a vendor prefix to the CSS property you're testing</li>
              <li>If the prefix is necessary, your test will appear to fail without it</li>
              <li>However, do not include vendor prefixes when pushing tests to the W3C</li>
            </ul>
          </section>
        </section>

        <!-- Review test -->
        <section>
          <h1>How to Review W3C Tests</h1>
          <h2>or How to Have Tests that Pass Review</h2>
          <p>
            <i>Zhiqiang Zhang (<a href="https://github.com/zqzhang" class="url Nickname">zqzhang</a>), <a class="org" href="http://www.intel.com/">Intel</a></i>
          </p>
        </section>

        <section>
          <section>
            <h2>Who Can Review a W3C Test?</h2>
            <p>Anyone but the test author!</p>
            <ul>
              <li>Spec editors</li>
              <li>Test coordinator</li>
              <li>Implementors</li>
              <li>Anyone with good working knowledge of the spec</li>
            </ul>
          </section>
          <section>
            <h2>Merged?</h2>
          </section>
          <section>
            <h2>Checklist for all tests</h2>
            <ul>
              <li>The test follows the format and style guidelines</li>
              <li>The test passes when it's supposed to pass</li>
              <li>The test fails when it's supposed to fail</li>
              <li>The test is testing what it thinks it's testing</li>
              <li>The spec backs up the expected behavior in the test</li>
              <li>The test is automatable as either reftest or a script test</li>
            </ul>
          </section>
          <section>
            <h2>Checklist for Reftests only</h2>
            <ul>
              <li>The test has a self-describing statement</li>
              <li>The self-describing statement is accurate, precise, simple, and self-explanatory.</li>
              <li>The reference file is accurate and will render pixel-perfect identically to the test on all platforms.</li>
              <li>The reference file uses a different technique that won't fail in the same way as the test.</li>
              <li>The title is descriptive but not too wordy.</li>
              <li>The test is as cross-platform as reasonably possible</li>
            </ul>
          </section>
          <section>
            <h2>Notes</h2>
            <ul>
              <li>A reviewer can be a colleague of the contributor as long as the proceedings are public</li>
              <li>A reviewer cannot review his/her own tests and changes</li>
              <li>All reviews should be fully transparrent by having all review comments on GitHub</li>
            </ul>
          </section>
        </section>

        <!-- Bug report -->
        <section>
          <h1>Where to Report Bugs</h1>
          <p>
            <i>Zhiqiang Zhang (<a href="https://github.com/zqzhang" class="url Nickname">zqzhang</a>), <a class="org" href="http://www.intel.com/">Intel</a></i>
          </p>
        </section>

        <section>
          <section>
            <h2>Where to Report a Bug?</h2>
            <ul>
              <li>Test bugs:</li>
              <ul>
                <li><a href="https://github.com/w3c/web-platform-tests/issues">https://github.com/w3c/web-platform-tests/issues</a></li>
                <li><a href="https://test.csswg.org/shepherd/">https://test.csswg.org/shepherd/</a></li>
              </ul>
              <li>Browser bugs:</li>
              <ul>
                <li><a href="https://bugzilla.mozilla.org/">Mozilla Bugzilla</a>, <a href="https://bugs.webkit.org/">WebKit Bugzilla</a>, <a href="http://crbug.com/">Chrome Bugs</a>, <a href="http://connect.microsoft.com/IE">IE Bugs</a>, <a href="http://pcbbs.baidu.com/forum.php?gid=1">Baidu Bugs</a>, <a href="https://bugs.tizen.org/">Tizen Web Runtime Bugs</a></li>
                <li>Other browsers - please check vendor's website for bug reporting information</li>
              </ul>
              <li>Spec bugs:</li>
              <ul>
                <li><a href="https://www.w3.org/Bugs/Public/">W3C Bugzilla</a></li>
                <li><a href="http://lists.w3.org/">W3C mailing lists</a></li>
              </ul>
            </ul>
          </section>
        </section>

        <section>
          <h2>References</h2>
          <ul>
            <li><a href="http://testthewebforward.org/docs/">http://testthewebforward.org/docs/</a></li>
            <ul>
              <li><a href="http://testthewebforward.org/docs/reftests.html">Reftest Documentation</a></li>
              <li><a href="http://testthewebforward.org/docs/test-format-guidelines.html">Test Format Guidelines</a></li>
              <li><a href="http://testthewebforward.org/docs/test-style-guidelines.html">Test Style Guidelines</a></li>
              <li><a href="http://testthewebforward.org/docs/test-templates.html">Test Templates</a></li>
              <li><a href="http://testthewebforward.org/docs/review-process.html">Test Review and Approval Process</a></li>
              <li><a href="http://testthewebforward.org/docs/review-checklist.html">Test Review Checklist</a></li>
              <li><a href="http://testthewebforward.org/docs/bugs.html">How to Report a Bug</a></li>
            </ul>
            <li><a href="https://github.com/w3c/web-platform-tests">https://github.com/w3c/web-platform-tests</a></li>
            <li><a href="https://github.com/w3c/csswg-test">https://github.com/w3c/csswg-test</a></li>
          </ul>
        </section>

        <section>
          <h2>Acknowledgements</h2>
          <ul>
            <li>Rebecca Hauck & Jacob Goldstein, <a href="http://adobe.github.io/web-platform/presentations/test-the-web-forward-tutorial/index.html">Learn how to create a W3C Ref and JS tests</a></li>
            <li>Elika J. Etemad, <a href="http://fantasai.inkedblade.net/style/talks/filing-good-bugs/">How to File a Good Bug Report</a></li>
            <br>
            <li>Gerard Talbot, <a href="http://lists.w3.org/Archives/Public/public-css-testsuite/2012Nov/0037.html">background-size-[025-029]: available, improved replacements</a></li>
            <li>Hakim El Hattab, <a href="https://github.com/hakimel/reveal.js">reveal.js</a></li>
          </ul>
        </section>
        
        <section>
          <h2>Ready? Go!</h2>
          <ul>
            <li>Let's start the Test Hackathon!</li>
            <br>
            <li>Write test cases for the 8 specs and beyond.</li>
            <br>
            <li>File good bug reports.</li>
          </ul>
        </section>

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
          // { src: 'plugin/leap/leap.js', async: true }
          // { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
          // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
